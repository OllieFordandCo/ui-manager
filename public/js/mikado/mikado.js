"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),Mikado=function(){function e(){_classCallCheck(this,e),this.w=window,this.doc=document,this.html=this.doc.documentElement,this.polyfillReady=!1,this.systemReady=!1;var t=void 0,o={module_url:"dist/js/mikado/modules/",vendor_url:"dist/js/vendor/",dev:!1},a=window.mikadoConfig||{};for(t in o)t in a||(a[t]=o[t]);this.config=a;var n=this;this.doc.addEventListener("polyfillReady",function(){n.polyfillReady=!0}),this.doc.addEventListener("DOMContentLoaded",function(){Base.logger("Window Loaded: loading enhancers..."),n.initHeightWatcher(),n.initMenuToggle(),n.loadEnhancers()}),this.doc.addEventListener("systemReady",function(){n.systemReady=!0})}return _createClass(e,[{key:"toggle",value:function(e){e.preventDefault(),e.stopPropagation();var t="togglerTarget"in this.dataset?document.querySelectorAll(this.dataset.togglerTarget):[this],o=this.dataset.toggler?this.dataset.toggler:"toggler-toggl";"classPrefix"in this.dataset&&this.className.indexOf(this.dataset.classPrefix)>-1||Base.forEach(t,function(e,t){t&&t.className.indexOf(o+"ed")>-1?(t.classList.add(o+"ing"),t.classList.remove(o+"ed"),setTimeout(function(){t.classList.remove(o+"ing")},300),console.log("untoggled")):t&&(t.classList.add(o+"ed"),console.log("toggled"))})}},{key:"unToggle",value:function(e){e.stopPropagation();var t=this.dataset.classPrefix;if(e.target.className.indexOf(t)>-1)return!1;var o=t+"ed",a=document.querySelectorAll("."+o);e.target;console.log("untoggled"),Base.forEach(a,function(e,o){o.classList.add(t+"ing"),o.classList.remove(t+"ed"),setTimeout(function(){o.classList.remove(t+"ing")},300)})}},{key:"initMenuToggle",value:function(){var e=document.querySelectorAll("[data-toggler]"),t=this;Base.forEach(e,function(e,o){var a=o.dataset.toggler?o.dataset.toggler:"toggler-toggl",n="togglerDismiss"in o.dataset&&document.querySelectorAll(o.dataset.togglerDismiss);n&&Base.forEach(n,function(e,n){n!=o&&(n.dataset.classPrefix=a,n.addEventListener("click",t.unToggle))}),o.addEventListener("click",t.toggle)})}},{key:"moduleURL",value:function(e){var t=window.mikadoConfig||{module_url:"dist/js/mikado/modules/"};return t.module_url+e}},{key:"loadSystemJs",value:function(){e.loadConditionalGlobal("body","System",this.moduleURL("system.min.js"),function(){var e=window.systemConfig||{};SystemJS.config(e),Base.triggerEvent("systemReady")})}},{key:"loadLazySizes",value:function(){var t=!1;document.querySelector("[data-bg]")?(e.loadConditionalGlobal("[data-bg]","unveilhooks",mikado.moduleURL("ls.unveilhooks.min.js"),function(){Base.triggerEvent("loadLazySizes")},null),t=!1):t=!0,document.addEventListener("loadLazySizes",function(){window.lazySizesConfig=window.lazySizesConfig||{};var t="lazyClass"in window.lazySizesConfig?window.lazySizesConfig.lazyClass:".lazyload";e.loadConditionalGlobal(t,"lazysizes",mikado.moduleURL("lazysizes.min.js"),function(){},"lazySizes")}),t&&Base.triggerEvent("loadLazySizes")}},{key:"initHeightWatcher",value:function(){requestAnimationFrame(function(){e.doHeightWatcher()}),window.addEventListener("resize",base.throttle(e.doHeightWatcher,100)),window.addEventListener("load",e.doHeightWatcher)}},{key:"loadEnhancers",value:function(){this.loadSystemJs(),e.loadConditionalGlobal("form","validate",this.moduleURL("validate.min.js")),this.loadLazySizes()}}],[{key:"loadConditionalImport",value:function(e,t,o){if(document.querySelector(e))return"System"in window?System["import"](t).then(o):(document.addEventListener("systemReady",function(){System["import"](t).then(o)}),!1)}},{key:"loadConditionalGlobal",value:function(e,t,o,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(a=a||function(){},document.querySelector(e)){var i="script#"+t;document.querySelector(i)?n in window?a.call():document.querySelector(i).addEventListener("load",function(){a.call()}):Base.loadScript(o,a,t)}}},{key:"doHeightWatcher",value:function(){console.log("updating Watchers");var e=document.querySelectorAll("[data-height-watcher]"),t=document.querySelectorAll("[data-height-offset]"),o=0;console.log("doing Watchers"),Base.forEach(t,function(e,t){o+=t.clientHeight}),Base.forEach(e,function(e,t){var a="heightFactor"in t.dataset?t.dataset.heightFactor:1;t.style.height=(window.innerHeight-o)*a+"px"})}}]),e}(),mikado=new Mikado;